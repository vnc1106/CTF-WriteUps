# ecc

![ecc](../_img/ecc.png)

Đề chỉ cho 1 file output duy nhất...

```python
flag bits: 606
e = 0x10001
n = 61262574892917665379101848600282751252633178779864648655116434051615964747592676204833262666589440081296571836666022795166255640192795587508845265816642144669301520989571990670507103278098950563219296310830719975959589061794360407053224254135937766317251283933110936269282950512402428088733821277056712795259
c = 16002162436420434728223131316901476099110904029045408221515087977802746863468505266500673611412375885221860212238712311981079623398373906773247773552766200431323537510699147642358473715224124662007742017000810447999989426207919068340364725395075614636875116086496704959130761547095168937180751237132642548997
G = (3364552845709696244757995625685399274809023621531082895612949981433844727622567352338990765970534554565693355095508508160162961299445890209860508127449468 : 4874111773041360858453223185020051270111929505293131058858547656851279111764112235653823943997681930204977283843433850957234770591933663960666437259499093 : 1)
3G = (8240596254289477251157504980772167439041663401504657696787046343848644902166655624353107697436635678388969190302189718026343959470011854412337179727187240 : 4413479999185843948404442728411950785256136111461847698098967018173326770728464491960875264034301169184074110521039566669441716138955932362724194843596479 : 1)
```

Theo mình đề chỉ cho nhiêu đây mà không giải thích gì thêm thì rất khó tiếp cận, may mắn trước đó mình có làm một bài tương tự... chi tiết mình đã viết wu [ở đây](https://vnc1106.github.io/2022/08/07/cor.html#threetreasures)

Đầu tiên có 2 điểm thì dễ dàng tìm được a và b, sau đó tính tọa điểm 3G trên Curve Zmod(n) và tọa độ đó sẽ đồng dư với tọa độ đề cho theo mod p...

```python
# sagemath

from Crypto.Util.number import *

e = 0x10001
n = 61262574892917665379101848600282751252633178779864648655116434051615964747592676204833262666589440081296571836666022795166255640192795587508845265816642144669301520989571990670507103278098950563219296310830719975959589061794360407053224254135937766317251283933110936269282950512402428088733821277056712795259
c = 16002162436420434728223131316901476099110904029045408221515087977802746863468505266500673611412375885221860212238712311981079623398373906773247773552766200431323537510699147642358473715224124662007742017000810447999989426207919068340364725395075614636875116086496704959130761547095168937180751237132642548997
G = (3364552845709696244757995625685399274809023621531082895612949981433844727622567352338990765970534554565693355095508508160162961299445890209860508127449468, 4874111773041360858453223185020051270111929505293131058858547656851279111764112235653823943997681930204977283843433850957234770591933663960666437259499093)
P = (8240596254289477251157504980772167439041663401504657696787046343848644902166655624353107697436635678388969190302189718026343959470011854412337179727187240, 4413479999185843948404442728411950785256136111461847698098967018173326770728464491960875264034301169184074110521039566669441716138955932362724194843596479)

Zn = Zmod(n)
# y^2 = x^3 + ax + b
A = matrix(Zn, [[G[0], 1], [P[0], 1]])
B = vector(Zn, [G[1]^2 - G[0]^3, P[1]^2 - P[0]^3])
a, b = A.solve_right(B)

# P is calculated over GF(p) while _P is over Zmod(n)
E = EllipticCurve(Zn, [a, b])
G = E.point(G)
_P = 3*G

p = gcd(_P.xy()[0] - P[0], n)
q = n//ZZ(p)
d = inverse_mod(e, (p - 1)*(q - 1))
f = pow(c, d, n)

flag = int(ZZ(a%p)*2**404 + ZZ(b%p)*2**202 + f)
print(long_to_bytes(flag))

# Flag: wmctf{$$U_c0u1d_s01v3_e11iptiCurv3_s0_34sily$$0f19d82199a0db0dee31fa12330307ea90aa}
```

**Flag: wmctf{\$\$U_c0u1d_s01v3_e11iptiCurv3_s0_34sily$$0f19d82199a0db0dee31fa12330307ea90aa}**